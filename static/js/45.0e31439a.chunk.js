"use strict";(self.webpackChunkmy_git_app=self.webpackChunkmy_git_app||[]).push([[45,656],{3045:function(e,r,t){t.r(r),t.d(r,{default:function(){return h}});var s=t(9439),n=t(2791),a=t(7689),i=t(1087),c=t(9434),o=t(6590),l=t(2693),u=t(6943),d=(t(6656),t(184)),h=function(){var e=(0,c.I0)(),r=(0,a.TH)(),t=(0,n.useState)(!1),h=(0,s.Z)(t,2),m=h[0],v=h[1],g=JSON.parse(localStorage.getItem("tourdetail")),p=(0,a.s0)(),x=(0,c.v9)((function(e){return e.auth})),j=x.user,_=x.isError,f=x.isSuccess,b=x.message,k=x.isLoading;(0,n.useEffect)((function(){var t=r.pathname;"/tourdetail"===t&&v(!0),"/"===t&&v(!1),k&&u.Z,_&&l.Z,f&&(j?console.log("change here in homepage jsx"):p("/login")),e((0,o.mc)())}),[j,k,_,f,b,e,p]);var w="All Tours",N=r.pathname;return g&&"/tourdetail"===N&&(w=g.tour.name),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"homepage_class",children:[(0,d.jsxs)("nav",{nav_bar:!0,className:"nav_container",children:[(0,d.jsx)("div",{className:"left_nav",children:m&&g?(0,d.jsx)("h2",{children:w}):(0,d.jsx)("h2",{children:"All Tours"})})," ",(0,d.jsxs)("div",{className:"right_nav",children:[(0,d.jsxs)("ul",{children:[" ",j?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("li",{children:[(0,d.jsxs)("button",{className:"nav_logout_button",onClick:function(r){r.preventDefault(),e((0,o.kS)()),e((0,o.mc)())},children:["Logout"," "]})," "]}),(0,d.jsxs)("li",{children:[(0,d.jsx)(i.rU,{to:"/dashboard",children:(0,d.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(j.photo),alt:"dashboardLink"})})," "]})," "]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("li",{children:[(0,d.jsxs)("button",{className:"nav_login_button",onClick:function(e){e.preventDefault(),p("/login")},children:["Login"," "]})," "]})," ",(0,d.jsxs)("li",{children:[(0,d.jsxs)("button",{className:"nav_register_button",onClick:function(e){e.preventDefault(),p("/register")},children:["Register"," "]})," "]})," "]})," "]})," "]})," "]})," "]})," "]})}},6656:function(e,r,t){t.r(r),t.d(r,{default:function(){return v}});var s=t(4165),n=t(5861),a=t(4942),i=t(1413),c=t(9439),o=t(2791),l=t(7689),u=t(3473),d=t(2388),h=t(2693),m=t(184),v=function(){(0,l.TH)();var e=(0,l.s0)(),r=JSON.parse(localStorage.getItem("tourdetail")),t=JSON.parse(localStorage.getItem("user")),v=(0,o.useState)(!0),g=(0,c.Z)(v,2),p=g[0],x=g[1],j=(0,o.useState)({review:"",rating:""}),_=(0,c.Z)(j,2),f=_[0],b=_[1],k=f.review,w=f.rating,N=function(e){e.preventDefault(),b((function(s){var n;return(0,i.Z)((0,i.Z)({},s),{},(n={},(0,a.Z)(n,e.target.name,e.target.value),(0,a.Z)(n,"user",t.id),(0,a.Z)(n,"tour",r.tour._id),n))}))},Z=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(r){var n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.token,e.prev=1,e.next=4,d.Z.post("http://127.0.0.1:8000/api/v1/reviews",r,{headers:{Authorization:"Bearer ".concat(n)}});case 4:return a=e.sent,e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(1),console.warn(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),A=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(r){var n,a,i,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.token,e.prev=1,e.next=4,(0,u.J)("pk_test_51LhXM5SBrxf9grZuKlaBjNwd4LPft9O4c06bUKX8eBsgSBgcxaxMcm2jDFZZtTcRmVitjammnAkHhD19KLepU0ns00ZPAKOmmI");case 4:return a=e.sent,e.next=7,d.Z.get("http://127.0.0.1:8000/api/v1/bookings/checkout-session/".concat(r),{headers:{Authorization:"Bearer ".concat(n)}});case 7:return i=e.sent,e.next=10,a;case 10:return c=e.sent,e.next=13,c.redirectToCheckout({sessionId:i.data.session.id});case 13:return e.abrupt("return",i);case 16:e.prev=16,e.t0=e.catch(1),h.Z,e.t0.message;case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(r){return e.apply(this,arguments)}}();if(t)return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"detail_container",children:[(0,m.jsxs)("div",{className:"detail_cover",children:[(0,m.jsxs)("span",{children:[" ",r.tour.name," "]})," ",(0,m.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(r.tour.imageCover),alt:"",className:"image_cover_class"})]})," ",(0,m.jsxs)("div",{className:"tour_detail",children:[(0,m.jsx)("h1",{children:"About Tour"}),(0,m.jsxs)("div",{children:[" ",r.tour.description," "]})," "]})," ",(0,m.jsx)("div",{className:"tour_image_container",children:r.tour.images.map((function(e,r){return(0,m.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(e),alt:"user_img",className:" tour_images "},r)}))}),(0,m.jsxs)("div",{className:"tour_btn_and_carddetail",children:[r.tour.guides.map((function(e,r){return(0,m.jsxs)("div",{className:"detail_card",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"guide_image",children:(0,m.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(e.photo),alt:"GuidesImg"})}),(0,m.jsx)("span",{style:{color:"yellow"},children:e.name})]},r),(0,m.jsxs)("div",{className:"price",children:["Price:",e.price," "]})," ",(0,m.jsx)("span",{children:" Duration |".concat(e.duration," days")})]},r)})),(0,m.jsxs)("div",{className:"book_tour_button",children:[(0,m.jsx)("div",{className:"bok_btn_user_img",children:(0,m.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(t.photo),alt:"user_img"})}),(0,m.jsx)("p",{children:"Book your Tour now and enjoy your Weekend ..."}),(0,m.jsx)("button",{className:"booktour_btn","data-tourid":r.tour.id,onClick:function(e){e.preventDefault();var r=e.target.getAttribute("data-tourid");A(r),console.log(r)},children:"Book Tour"})]})]}),(0,m.jsx)("div",{children:(0,m.jsx)("h3",{className:"reviews_border",children:"Reviews..."})}),(0,m.jsxs)("footer",{className:"reviews_and_reviewarea",children:[r.tour.reviews.map((function(e,t){var s=e.review,n=e.user;return(0,m.jsxs)("div",{className:"review_card",children:[(0,m.jsx)("div",{className:"review_img_cover",children:(0,m.jsx)("img",{src:"./Abhishek-stark-reactapp/".concat(n.photo),alt:"user_img",className:"review_user_img"})}),(0,m.jsx)("h3",{children:n.name}),(0,m.jsx)("p",{children:s}),(0,m.jsxs)("span",{children:["AverageRating: ",r.tour.ratingsAverage]}),(0,m.jsx)("div",{className:"rating_star",children:(0,m.jsx)("h3",{children:"gradeIcon"})})]},t)})),(0,m.jsxs)("section",{className:"footer_card",children:[p?(0,m.jsx)("button",{id:"add_review_btn",onClick:function(e){e.preventDefault(),r.tour.reviews.map((function(e){e.user._id===t.id&&(window.alert("you already written review"),console.log("under if"),x(!0)),e.user._id!==t.id&&(x(!1),console.log("under else"),b({review:"",rating:""}))}))},children:"Write Review"}):null,p?null:(0,m.jsx)("form",{onSubmit:function(r){if(r.preventDefault(),null==f.review.match(/\S/g))return x(!p);Z(f),b(!p),e("/")},children:(0,m.jsxs)("div",{children:[(0,m.jsx)("textarea",{name:"review",id:"review",value:k,cols:"30",rows:"10",onChange:N}),(0,m.jsx)("input",{type:"text",name:"rating",id:"rating",value:w,onChange:N}),(0,m.jsx)("button",{type:"submit",id:"review_submit_btn",children:"Submit"})]})})]})]})]})," "]})}}}]);
//# sourceMappingURL=45.0e31439a.chunk.js.map